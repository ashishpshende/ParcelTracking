{"version":3,"file":"src_app_pages_public_forgot-password_forgot-password_module_ts.js","mappings":"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","sources":["./src/app/pages/public/forgot-password/forgot-password-routing.module.ts","./src/app/pages/public/forgot-password/forgot-password.module.ts","./src/app/pages/public/forgot-password/forgot-password.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { ForgotPasswordPage } from './forgot-password.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: ForgotPasswordPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class ForgotPasswordPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { SharedModule } from '../../../shared/shared/shared.module';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { ForgotPasswordPageRoutingModule } from './forgot-password-routing.module';\r\n\r\nimport { ForgotPasswordPage } from './forgot-password.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    ReactiveFormsModule,\r\n    ForgotPasswordPageRoutingModule,\r\n    SharedModule,\r\n    TranslateModule.forChild()\r\n  ],\r\n  declarations: [ForgotPasswordPage]\r\n})\r\nexport class ForgotPasswordPageModule {}\r\n","/* eslint-disable max-len */\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { NavigationExtras } from '@angular/router';\r\nimport { NavController, MenuController, LoadingController, AlertController } from '@ionic/angular';\r\nimport { User } from 'src/app/models/user';\r\nimport { HelperService } from 'src/app/services/helpers/helper-service';\r\nimport { LanguageService } from 'src/app/services/language/language.service';\r\nimport { UserService } from 'src/app/services/user/user.service';\r\n\r\n@Component({\r\n  selector: 'app-forgot-password',\r\n  templateUrl: './forgot-password.page.html',\r\n  styleUrls: ['./forgot-password.page.scss'],\r\n})\r\nexport class ForgotPasswordPage implements OnInit {\r\n  public userEmailValidationMessage:string=\"\";\r\n  public userNameValidationMessage:string=\"\";\r\n\r\n  public userEmail:string=\"\";\r\n  public userName:string=\"\";\r\n  public enableRequestButton:boolean=false;\r\n  private localUser:User;\r\n  private loading:any;\r\n  private allowClose: boolean= false;\r\n  constructor(\r\n    private alertController: AlertController,\r\n    private loadingController:LoadingController,\r\n    private userService:UserService,\r\n    private languageService:LanguageService,\r\n    public navCtrl: NavController,\r\n    public loadingCtrl: LoadingController\r\n  ) {\r\n    this.localUser = new User(JSON.parse(\"{}\"));\r\n    this.userEmail = \"\"\r\n    this.userName = \"\";\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n  }\r\n\r\n  ngOnInit() {\r\n\r\n\r\n  }\r\n  userNameTextChanged()\r\n  {\r\n    this.validate();\r\n  }\r\n  emailTextChanged(){\r\n    this.validate();\r\n  }\r\n  validate()\r\n  {\r\n    if(this.validateEmail() && this.validateUsername())\r\n    {\r\n      this.enableRequestButton = true;\r\n      return true;\r\n    }\r\n    else\r\n    {\r\n      this.enableRequestButton = false;\r\n      return false;\r\n    }\r\n  }\r\n  validateUsername()\r\n  {\r\n\r\n    if(this.userName==null || this.userName ==undefined ||this.userName.length==0 )\r\n    {\r\n      this.userNameValidationMessage = this.languageService.translate('FORGOT_PASSWORD_PAGE.USER_NAME_SYNTAX_VALIDATING_MESSAGE');\r\n      return false;\r\n    }\r\n    else\r\n    {\r\n      this.userNameValidationMessage = \"\";\r\n      return true;\r\n    }\r\n    return true;\r\n  }\r\n  validateEmail()\r\n  {\r\n    var result =    HelperService.validateEmail(this.userEmail);\r\n    if(this.userEmail.length>0 && !result)\r\n    {\r\n      this.userEmailValidationMessage = this.languageService.translate('FORGOT_PASSWORD_PAGE.EMAIL_SYNTAX_VALIDATING_MESSAGE');\r\n    }\r\n    else\r\n    {\r\n      this.userEmailValidationMessage = \"\";\r\n    }\r\n    return result;\r\n  }\r\n  async RequestPasswordButtonClicked() {\r\n    const loader = await this.loadingCtrl.create({\r\n      message:  this.languageService.translate('FORGOT_PASSWORD_PAGE.VALIDATING_MESSAGE'),\r\n      duration: 3000\r\n    });\r\n    loader.present();\r\n      this.userService.getUserByUserNameEmail(this.userName, this.userEmail, async response => {\r\n        if(response === null|| response === undefined  || response.results.length === 0)\r\n        {\r\n          loader.dismiss();\r\n            this.presentAlert(this.languageService.translate('FORGOT_PASSWORD_PAGE.EMAIL_NOT_SENT_TITLE'),this.languageService.translate('FORGOT_PASSWORD_PAGE.INVALID_DETAILS_MESSAGE'));\r\n        }\r\n        else\r\n        {\r\n          loader.dismiss();\r\n          this.localUser = response.result[0];\r\n          await this.updateUserCredentials();\r\n        }\r\n\r\n      },\r\n      failure => {\r\n        this.presentAlert('FORGOT_PASSWORD_PAGE.EMAIL_NOT_SENT_TITLE','FORGOT_PASSWORD_PAGE.VALIDATION_FAILED_MESSAGE')\r\n\r\n      });\r\n\r\n      // loader.onWillDismiss().then(() => {\r\n      //   let navigationExtras: NavigationExtras = {\r\n      //     queryParams: {\r\n      //       ts: new Date().getMilliseconds()\r\n      //     }\r\n      //   };\r\n      //   this.navCtrl.navigateRoot('/login',navigationExtras);\r\n      // });\r\n  }\r\n\r\n async updateUserCredentials()\r\n  {\r\n    const loader = await this.loadingCtrl.create({\r\n      message:  this.languageService.translate('FORGOT_PASSWORD_PAGE.GENERATING_TEMP_PASSWORD'),\r\n      duration: 3000\r\n    });\r\n    loader.present();\r\n    this.localUser.Password = HelperService.generateTempPassowrd();\r\n    this.userService.UpdateUserCredentials(this.localUser, async response => {\r\n      if(response === null|| response === undefined )\r\n      {\r\n        loader.dismiss();\r\n          this.presentAlert(this.languageService.translate('FORGOT_PASSWORD_PAGE.EMAIL_NOT_SENT_TITLE'),this.languageService.translate('FORGOT_PASSWORD_PAGE.INVALID_DETAILS_MESSAGE'));\r\n      }\r\n      else\r\n      {\r\n        loader.dismiss();\r\n        this.sendEmail();\r\n      }\r\n\r\n    },\r\n    failure => {\r\n      this.presentAlert(this.languageService.translate('FORGOT_PASSWORD_PAGE.EMAIL_NOT_SENT_TITLE'),this.languageService.translate('FORGOT_PASSWORD_PAGE.VALIDATION_FAILED_MESSAGE'));\r\n\r\n    });\r\n  }\r\n  async sendEmail()\r\n  {\r\n    this.loading = await this.loadingController.create({\r\n      message:  this.languageService.translate('FORGOT_PASSWORD_PAGE.EMAIL_SENDING_MESSAGE'),\r\n      duration: 2000,\r\n    });\r\n\r\n    this.loading.present();\r\n    this.userService.sendForgotPasswordEmail(this.localUser.FirstName + ' '+ this.localUser.LastName,\r\n    this.localUser.UserName,\r\n    this.localUser.Email,\r\n    this.localUser.Password,\r\n     async response => {\r\n      switch(response){\r\n        case 'sent':\r\n          this.presentAlert(this.languageService.translate('FORGOT_PASSWORD_PAGE.EMAIL_SENT_TITLE'), this.languageService.translate('FORGOT_PASSWORD_PAGE.EMAIL_SENT_MESSAGE'));\r\n          break;\r\n        default:\r\n          this.presentAlert(this.languageService.translate('FORGOT_PASSWORD_PAGE.EMAIL_NOT_SENT_TITLE'), this.languageService.translate('FORGOT_PASSWORD_PAGE.EMAIL_EXHAUSTED'));\r\n          break;\r\n      }\r\n      this.allowClose =true;\r\n    },\r\n    failure => {\r\n      this.allowClose =false;\r\n      this.presentAlert(this.languageService.translate('FORGOT_PASSWORD_PAGE.VALIDATION_FAILED_MESSAGE'),this.languageService.translate('FORGOT_PASSWORD_PAGE.VALIDATION_FAILED_MESSAGE'));\r\n\r\n    });\r\n  }\r\n  // // //\r\n  goToLogin() {\r\n    this.navCtrl.navigateRoot('/');\r\n  }\r\n  //Alerts\r\n  async presentAlert(headerTitle = this.languageService.translate('FORGOT_PASSWORD_PAGE.VALIDATION_FAILED_TITLE'), message = this.languageService.translate('LOGIN.ERROR_INVALID_CREDENTIALS_MESSAGE')) {\r\n    const alert = await this.alertController.create({\r\n      cssClass: 'my-custom-class',\r\n      header: headerTitle,\r\n      subHeader: \"\",\r\n      message: message,\r\n      buttons: [\r\n         {\r\n          text: this.languageService.translate('BUTTONS.OK'),\r\n          handler: data => {\r\n            if(this.allowClose)\r\n            {\r\n              let navigationExtras: NavigationExtras = {\r\n                queryParams: {\r\n                  ts: new Date().getMilliseconds()\r\n                }\r\n              };\r\n              this.navCtrl.navigateRoot('/login',navigationExtras);\r\n            }\r\n          }\r\n        }]\r\n    });\r\n\r\n    await alert.present();\r\n\r\n    const { role } = await alert.onDidDismiss();\r\n  }\r\n\r\n}\r\n"],"names":["Component","NavController","LoadingController","AlertController","User","HelperService","LanguageService","UserService","ForgotPasswordPage","constructor","alertController","loadingController","userService","languageService","navCtrl","loadingCtrl","localUser","JSON","parse","userEmail","userName","ionViewWillEnter","ngOnInit","userNameTextChanged","validate","emailTextChanged","validateEmail","validateUsername","enableRequestButton","undefined","length","userNameValidationMessage","translate","result","userEmailValidationMessage","RequestPasswordButtonClicked","loader","create","message","duration","present","getUserByUserNameEmail","response","dismiss","presentAlert","updateUserCredentials","failure","Password","generateTempPassowrd","UpdateUserCredentials","sendEmail","loading","sendForgotPasswordEmail","FirstName","LastName","UserName","Email","allowClose","goToLogin","navigateRoot","headerTitle","alert","cssClass","header","subHeader","buttons","text","handler","data","navigationExtras","queryParams","ts","Date","getMilliseconds","role","onDidDismiss","selector","template"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}